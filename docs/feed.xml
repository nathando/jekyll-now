<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2020-04-15T08:34:06+07:00</updated><id>/feed.xml</id><title type="html">Nathan Do</title><subtitle>life_of.py</subtitle><entry xml:lang="vn"><title type="html">Viet An 2020</title><link href="/2020/03/29/Viet-An.html" rel="alternate" type="text/html" title="Viet An 2020" /><published>2020-03-29T00:00:00+07:00</published><updated>2020-03-29T00:00:00+07:00</updated><id>/2020/03/29/Viet-An</id><content type="html" xml:base="/2020/03/29/Viet-An.html">&lt;h1 id=&quot;việt-an-19feb2020&quot;&gt;Việt An 19/Feb/2020&lt;/h1&gt;
&lt;p&gt;Ngày 19 tháng 2, từ nay trở thành một ngày hết sức đặc biệt. Ngày con gái chào đời. Blog đầu tiên bằng tiếng Việt của mình đánh dấu một hành trình mới.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;An&lt;/strong&gt; sinh ra giữa lúc đại dịch đang làm xáo trộn tất cả mọi thứ. Chính phủ phải phong toả thành phố, mọi người phải giữ khoảng cách với nhau đề phòng dịch bệnh. Hàng quán phải theo lệnh đóng cửa. Điểm tích cực duy nhất là mức độ ô nhiễm của Sài Gòn giảm đáng kể, phố xá vắng lặng. Điều mà nhiều thập kỷ qua không hề thấy được. Học sinh có kỳ nghỉ Tết dài nhất trong nhiều chục năm, có lẽ là trong cả đời đi học.&lt;/p&gt;

&lt;p&gt;Lúc đang viết thì thế giới đã có hơn 600K người nhiễm bệnh, hơn 30K người đã tử vong. Từ đây đến cuối năm, khả năng cao là sẽ có suy thoái kinh tế. Hệ luỵ của việc này chắc hẳn cũng to lớn không kém thiệt hại nhân mạng. Tình trạng thất nghiệp sẽ gia tăng và đi cùng nó là tỉ lệ tội phạm.&lt;/p&gt;

&lt;p&gt;Trong cái sự hỗn loạn đó, 1 tháng vừa qua có vẻ như là 1 tháng dài nhất mình đã trải qua. Nó là 1 khoảng thời gian hết sức kỳ lạ với tất cả mọi người. Ngoài việc sức lây lan và huỷ diệt khủng khiếp, COVID-19 dường như đã ép thành công gần 70-80% dân số toàn cầu sống chậm lại. Ngay cả mẹ mình, 1 giáo viên văn cấp 3, người mà mình cho là &lt;code&gt;workaholic&lt;/code&gt; nhất thế giới, vì COVID-19, mà đã bắt đầu phát triển sở thích riêng, ngồi học vẽ bút chì. Còn vợ chồng mình thì tự nhiên cả 2 được ở nhà chăm An.&lt;/p&gt;

&lt;p&gt;Đối với nhiều gia đình, đây là thời gian gần như duy nhất cả nhà được cùng quây quần bên nhau. Làm việc ở nhà (Work from home) trở thành cụm từ &lt;code&gt;hot&lt;/code&gt;, hashtag #stayhome toàn trên top trending. Trong cái hỗn loạn, lại có đôi phần bình an.&lt;/p&gt;

&lt;p&gt;Hầu như đối với mọi thảm hoạ, những người lao động phổ thông, thu nhập thấp đều là những người ảnh hưởng đầu tiên. Hy vọng niềm tin và lòng nhân ái sẽ là ngọn đuốc soi đường sau thời kỳ đen tối này của dịch. Và hy vọng năm &lt;strong&gt;An&lt;/strong&gt; ra đời sẽ được nhớ đến bởi sự nỗ lực của con người chống chọi với dịch hoạ thay vì những bóng đen của khủng hoảng. Và cũng như tên con, mình mong nước Việt được bình an qua khỏi sóng gió.&lt;/p&gt;

&lt;p&gt;29 Mar 2020&lt;/p&gt;</content><author><name></name></author><category term="life" /><summary type="html">Việt An 19/Feb/2020 Ngày 19 tháng 2, từ nay trở thành một ngày hết sức đặc biệt. Ngày con gái chào đời. Blog đầu tiên bằng tiếng Việt của mình đánh dấu một hành trình mới.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/2020Mar/baby.jpg" /></entry><entry xml:lang="en"><title type="html">A new decade</title><link href="/2020/01/01/A-new-decade.html" rel="alternate" type="text/html" title="A new decade" /><published>2020-01-01T00:00:00+07:00</published><updated>2020-01-01T00:00:00+07:00</updated><id>/2020/01/01/A-new-decade</id><content type="html" xml:base="/2020/01/01/A-new-decade.html">&lt;blockquote&gt;
  &lt;p&gt;Life was not designed to give us what we want but life was designed to give us what we deserved&lt;/p&gt;
  &lt;p class=&quot;author&quot;&gt;Jim Rohn&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Today, 01-Jan-2020, marks a new decade. 
In 2010, I was just graduated for 1 year and still working in the University as a Research Officer.&lt;/p&gt;

&lt;p&gt;The last decade has been great to me:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Celebrate the decade long of love with wifey soon and will welcome our first kid next year&lt;/li&gt;
  &lt;li&gt;Been to 7 different countries, experienced a few of different cultures. Learnt Mandarin though not fluent still.&lt;/li&gt;
  &lt;li&gt;Jumping through a few jobs ranging from Academic Research to Game development, experience totally different working environments (both good and bad).&lt;/li&gt;
  &lt;li&gt;Joining a startup and following through for the last 5 years have taught me various skill sets from development to managing people.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/images/2020Jan/startup.jpg&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The transition from 20s to 30s, however, is rough. And it feels like a mid-life crisis is hanging there somewhere waiting for me.
But at the same time, coming back to Vietnam last year has made my mind clearer.
Last time while staying in Singapore, my purpose is blurry.
Granted that Singapore was clean, safe, and more advanced in almost all aspects but I really don’t know what I am doing there.
In Vietnam, I can tell surely that I will try my best contribute for a &lt;strong&gt;better environment and education&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2020Jan/environment_edu.jpg&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another thing only recently I have realised is the &lt;strong&gt;science of how we can grow better&lt;/strong&gt;.
Since young, I have been pretty confident about my own intellectual capacity.
And for that reason, most of the exams in my life, I usually only spent the short period right before them to study and still passed.
That was bad, in the sense that it has given me a totally wrong idea of how to master a skill or a subject.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1% daily does beat 10% for 1 month by a far distance&lt;/strong&gt; (if anyone counting then it is 1.01^30=34.7% vs 10%).
It applies to not only money but also our growth. A bit everyday is the best way to grow.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Habit is king, not perfection (so don’t waste time trying to make it perfect)&lt;/strong&gt;. It determines our behaviors, our characteristics. And therefore, our future, our successes.
Habits make us that magnet which can attract success, habits make us what we become, therefore, what we deserved.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2020Jan/thesun.jpg&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;</content><author><name></name></author><category term="life" /><summary type="html">Life was not designed to give us what we want but life was designed to give us what we deserved Jim Rohn</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/2020Jan/2020.jpg" /></entry><entry xml:lang="en"><title type="html">Binary</title><link href="/2019/11/25/When-everything-is-binary.html" rel="alternate" type="text/html" title="Binary" /><published>2019-11-25T00:00:00+07:00</published><updated>2019-11-25T00:00:00+07:00</updated><id>/2019/11/25/When-everything-is-binary</id><content type="html" xml:base="/2019/11/25/When-everything-is-binary.html">&lt;p&gt;The title might make you think that it is a tech-related post.&lt;br /&gt;
But by this &lt;code&gt;binary&lt;/code&gt;, I meant the polarizing extremes I’ve observed in life. 
And those ain’t working.&lt;/p&gt;

&lt;p&gt;In this modern world, I perceived the priorities of the people have been shifted into polarizing views of life.&lt;br /&gt;
Nowadays, with the epidemic of instant gratification, it is literally either now or never.&lt;br /&gt;
“If I buy some thing and it’s not appear in my front door in a week, I rather not having it.”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/binary-sides.jpg&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As the very end of this spectrum is the US where everything was designed for people to take sides, to start a debate:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Either you are fat shaming or you are fat glorifying.&lt;/li&gt;
  &lt;li&gt;Either you are vegan or you are cold blood animals slaughterer.&lt;/li&gt;
  &lt;li&gt;Either you are feminist or you have toxic masculinity.&lt;/li&gt;
  &lt;li&gt;Either you love guns or you are against the second amendment.&lt;/li&gt;
  &lt;li&gt;Each attached with a problem that is wrong about you, that you should feel obligation to change.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These are revealed not for the benefit of the people but for the corporations that are selling them solutions to the perceived problems. For example, if they are serious about Obesity, fast food chains and soda drink companies should be taxed much higher so that their price is less attractive and accessible. Rather than giving people reasons to stay happily unfit, give them reasons to be happy AND fit.&lt;/p&gt;

&lt;p&gt;For the longest time, I have been wondered why a country that is so advanced like the US can’t figure out how to solve its gun or obesity problem.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/binary-guns.jpg&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now I got it, because they (the government or at least some politician) does not want that.&lt;/p&gt;

&lt;p&gt;The corporate will pay them much more to keep it the way it is.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fast food chains, carbonated soda drink companies will be happier to have more people hooked in to its products because they are more accessible and cheaper than 
the healthier choices.&lt;/li&gt;
  &lt;li&gt;Kids are diagnosed with ADHD much more than ever to … make the pharmaceutical companies easier to subscribe them to their products.&lt;/li&gt;
  &lt;li&gt;And guns … some president somewhere actually suggested teachers to have more guns as solutions to School mass shootings… ‘nuff said.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I feel like we are staring at the inevitable destinations of consumerism machine created by powerful corporations. 
Their hands and legs are PR tactics and unethical marketing.&lt;/p&gt;

&lt;p&gt;Marketing used to be about letting people know about your products and their benefits.&lt;br /&gt;
Now, it is about how to plant an idea into your brain that you need the products regardless of the truth. (just like the Inception movie)&lt;/p&gt;

&lt;p&gt;I think the future lies in sustainable economics and not just profit-driven companies.&lt;br /&gt;
As much as I admire the genius of those marketing tactics, it will lead our world to more destruction. It is time to come back to the basics, to solve the actual problem which is the unsustanable life style caused by consumerism.&lt;/p&gt;

&lt;p&gt;Love this sentence from &lt;strong&gt;Jon Jandai&lt;/strong&gt;:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;We worked too much until we destroyed everything that feed us”&lt;br /&gt;
&lt;strong&gt;Jon Jandai&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/y_E0KwE7zL0&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;</content><author><name></name></author><category term="life" /><summary type="html">The title might make you think that it is a tech-related post. But by this binary, I meant the polarizing extremes I’ve observed in life. And those ain’t working.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/2019Nov/binary-logo.jpg" /></entry><entry xml:lang="en"><title type="html">Docker compose to AWS ECS Part 1</title><link href="/2019/11/03/Docker-compose-to-AWS-ECS.html" rel="alternate" type="text/html" title="Docker compose to AWS ECS Part 1" /><published>2019-11-03T00:00:00+07:00</published><updated>2019-11-03T00:00:00+07:00</updated><id>/2019/11/03/Docker-compose-to-AWS-ECS</id><content type="html" xml:base="/2019/11/03/Docker-compose-to-AWS-ECS.html">&lt;h2 id=&quot;what-are-docker-and-docker-compose-&quot;&gt;What are &lt;code&gt;Docker&lt;/code&gt; and &lt;code&gt;Docker-compose&lt;/code&gt; ?&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;Docker&lt;/code&gt; is a popular technology that allows us to run applications in isolated containers. 
It is similar to the old concept of virtual machines but running faster and consume less computing power.&lt;br /&gt;
&lt;code&gt;Docker-compose&lt;/code&gt; is an awesome tool that helps us orchestrate multiple containers to work together as the whole application.
Having been using &lt;code&gt;Docker-compose&lt;/code&gt; + &lt;code&gt;Docker&lt;/code&gt; for a few years, I am still quite satisfied with the way it handles container’s lifecycle and networking.&lt;/p&gt;

&lt;h2 id=&quot;what-is-aws-ecs-&quot;&gt;What is &lt;code&gt;AWS ECS&lt;/code&gt; ?&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/en_pv/AmazonECS/latest/developerguide/Welcome.html&quot;&gt;&lt;code&gt;AWS ECS (Amazon Elastic Container Service)&lt;/code&gt;&lt;/a&gt; is a container management service from Amazon. To explain it in simplest term, it is a more powerful, managed version of the &lt;a href=&quot;https://docs.docker.com/engine/swarm/&quot;&gt;&lt;code&gt;Docker-Swarm&lt;/code&gt;&lt;/a&gt; + &lt;code&gt;Docker-Compose&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/ecs-overview.png&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With that definition, shouldn’t the conversion from &lt;code&gt;Docker-compose&lt;/code&gt; to &lt;code&gt;AWS ECS&lt;/code&gt; be painless ? Truth is Amazon’s documentations are pretty overwhelming where not just &lt;code&gt;ECS&lt;/code&gt; but a lot of other &lt;code&gt;AWS&lt;/code&gt; Services are involved (&lt;code&gt;ECR&lt;/code&gt;, &lt;code&gt;CloudWatch&lt;/code&gt;, &lt;code&gt;EC2&lt;/code&gt;, &lt;code&gt;Secret Manager&lt;/code&gt;,  &lt;em&gt;optional&lt;/em&gt;: &lt;code&gt;RDS&lt;/code&gt;, &lt;code&gt;S3&lt;/code&gt;, etc.). And when I’ve first started, I feel quite clueless. So this is to help any one who has the same problem.&lt;/p&gt;

&lt;h2 id=&quot;from-compose-to-ecs&quot;&gt;From &lt;code&gt;Compose&lt;/code&gt; to &lt;code&gt;ECS&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;At start, I’ve wasted quite some time just to understand how are all services on &lt;code&gt;AWS ECS&lt;/code&gt; related to &lt;code&gt;Docker&lt;/code&gt;. For those who are familiar with Docker, here are the direct mappings between AWS and Docker technologies.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/docker-vs-aws.png&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;why-&quot;&gt;Why ?&lt;/h3&gt;
&lt;p&gt;Simple, because I wanted to tap on the power of other AWS Managed Services (like &lt;a href=&quot;https://aws.amazon.com/waf/&quot;&gt;&lt;code&gt;AWS WAF&lt;/code&gt;&lt;/a&gt; &lt;a href=&quot;https://aws.amazon.com/guardduty/&quot;&gt;&lt;code&gt;AWS GuardDuty&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://docs.aws.amazon.com/autoscaling/ec2/userguide/AutoScalingGroup.html&quot;&gt;&lt;code&gt;Auto Scaling Groups&lt;/code&gt;&lt;/a&gt;). It’s fine to run &lt;code&gt;Docker-compose&lt;/code&gt; simply on a normal EC2 instance (just a normal Virtual machine), but we will miss out on other great protection and add on service from AWS.&lt;br /&gt;
One important difference &lt;code&gt;Docker-compose&lt;/code&gt; vs. &lt;code&gt;AWS ECS&lt;/code&gt; is that &lt;code&gt;Docker-compose&lt;/code&gt; is a self-contained service. You can define all the images you need + build image from your code. There is, however, no &lt;code&gt;build&lt;/code&gt; in &lt;code&gt;AWS ECS&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;aws-flow&quot;&gt;AWS Flow&lt;/h3&gt;
&lt;p&gt;If you have used &lt;code&gt;Docker service&lt;/code&gt; and &lt;code&gt;Docker swarm&lt;/code&gt; before, it is pretty similar. But if like me, you only used &lt;code&gt;Docker compose&lt;/code&gt; before, then here how it looks like:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/aws-ecs-flow.png&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In this part, we will go through just first step to build the container images. &lt;code&gt;Docker-compose&lt;/code&gt; file is pretty self-contained that it can specify a direct build right inside where it is not possible for &lt;code&gt;AWS ECS Task&lt;/code&gt;. So we start with build the images.&lt;/p&gt;

&lt;h3 id=&quot;1-building-images&quot;&gt;1. Building images&lt;/h3&gt;
&lt;p&gt;Take an example of a Docker compose file with a few services.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;ss&quot;&gt;version: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2'&lt;/span&gt;
&lt;span class=&quot;ss&quot;&gt;services:
    nginx:
        image: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nginx&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:latest&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;hostname: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nginx&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;redis:
        image: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;redis&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:latest&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;hostname: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;redis&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;web:
        build:
            context: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;dockerfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dockerfile&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;env_file: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;envs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;env&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;command: &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;ports:
            &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;8000:8000&quot;&lt;/span&gt;
       &lt;span class=&quot;ss&quot;&gt;volumes:
        &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;
       &lt;span class=&quot;ss&quot;&gt;depends_on:
        &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nginx&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redis&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Only focus on those that we has to build first (in this case: &lt;code&gt;web&lt;/code&gt; service). 
The rest can be easily specify in task definition (ECS equilvalent of Docker-compose file). AWS ECR (Elastic Container Repositories) is Docker Hub equivalent. Process to build and push images is totally similar:&lt;/p&gt;

&lt;p&gt;Create a repository and copy the image&lt;/p&gt;

&lt;p&gt;After done, copy the url for later use. Your url will be in this format: 
&lt;strong&gt;your-account-id&lt;/strong&gt;.dkr.ecr.&lt;strong&gt;your-region&lt;/strong&gt;.amazonaws.com/&lt;strong&gt;your-repo&lt;/strong&gt;:latest&lt;/p&gt;

&lt;p&gt;Building the docker image:
&lt;code&gt;docker build -f Dockerfile -t .&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;2-define-task-definitions&quot;&gt;2. Define task definitions&lt;/h3&gt;
&lt;p&gt;Think of a ECS Task as a task (long running or one time) that is based on a the docker compose. 
Similar to how we call &lt;code&gt;docker-compose up&lt;/code&gt;, we use &lt;code&gt;AWS ECS Service&lt;/code&gt; to run &lt;code&gt;AWS ECS Task&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;21-container-images&quot;&gt;2.1 Container images&lt;/h4&gt;
&lt;p&gt;For this part, we keep it simple first. In this section, we define which image repositories to pull and start container.
In part 2, we will look at how to make it check for healthchecks and container dependencies. 
Here is the example of the &lt;code&gt;main&lt;/code&gt; container:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;web&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;essential&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-account-id.dkr.ecr.your-region.amazonaws.com/your-repo:latest&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;logConfiguration&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&quot;logDriver&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;awslogs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&quot;options&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;awslogs-group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;awslogs-region&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-region&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;awslogs-stream-prefix&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-prefix&quot;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;22-define-environments-and-secrets&quot;&gt;2.2 Define environments and secrets&lt;/h4&gt;
&lt;p&gt;For each container, you will need some parameters to be passed into it as environments.
AWS divide them into 2 sections:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;environment&lt;/code&gt;: list of environment variables you want to pass into container but not sensitive information&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;secrets&lt;/code&gt;: same as above except that these are sensitive information&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It is trivial to declare an &lt;strong&gt;environment&lt;/strong&gt; section:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;environment&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DJANGO_SETTINGS_MODULE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;web.settings.staging&quot;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;For &lt;strong&gt;secrets&lt;/strong&gt; section, we need to define them as secure/encrypted strings using AWS console. 
To do this, go to your AWS Console, search for &lt;code&gt;System Manager&lt;/code&gt;, click on &lt;code&gt;Parameter Store&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Create new secure string with properly scoped names like &lt;code&gt;/your-scope/PARAM_NAME&lt;/code&gt; (your-scope can be your environments like staging, production, etc.):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/aws-param1.png&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Enter value for the secret string and save&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019Nov/aws-param2.png&quot; class=&quot;img-auto&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Once the param created, your &lt;code&gt;arn&lt;/code&gt; will in the format of &lt;code&gt;arn:aws:ssm:your-region:your-account-id:parameter/your-scope/SECRET_KEY&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;secrets&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SECRET_KEY&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;arn:aws:ssm:your-region:your-account-id:parameter/your-scope/SECRET_KEY&quot;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;23-create-task-definition-with-aws-cli&quot;&gt;2.3 Create task definition with &lt;code&gt;aws cli&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;It is okay to create a Task Definition from console. 
However, I’ve found it much easier to create task definition using json. 
With all the section above, we can put everything together as a final json (saved as &lt;code&gt;task.json&lt;/code&gt;)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;executionRoleArn&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;arn:aws:iam::your-account-id:role/ecsTaskExecutionRole&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;containerDefinitions&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;web&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;essential&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-account-id.dkr.ecr.your-region.amazonaws.com/your-repo:latest&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;logConfiguration&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;logDriver&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;awslogs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;options&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;awslogs-group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;awslogs-region&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-region&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;awslogs-stream-prefix&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-prefix&quot;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;environment&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DJANGO_SETTINGS_MODULE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;web.settings.staging&quot;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;secrets&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SECRET_KEY&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;arn:aws:ssm:your-region:your-account-id:parameter/your-scope/SECRET_KEY&quot;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;cpu&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1024&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;memory&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1024&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;family&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your-task-family&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;With this json, we can run command to create a task with simple call to &lt;code&gt;aws cli&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;aws ecs register-task-definition --cli-input-json file://task.json&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Note: the path needs to start with &lt;code&gt;file://&lt;/code&gt; for aws command to be able to find the file.&lt;/p&gt;

&lt;p&gt;With this, you will be able to run the task itself. Next part we will look at how to:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Link multiple containers together with networking and exposed ports&lt;/li&gt;
  &lt;li&gt;Define healthchecks for containers so that we know if the container service is healthy&lt;/li&gt;
  &lt;li&gt;Mount docker volumes and use them in containers&lt;/li&gt;
  &lt;li&gt;Define service for the long running tasks and update the service with new task version&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="tech" /><category term="work" /><summary type="html">What are Docker and Docker-compose ?</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/2019Nov/compose-ecs.png" /></entry><entry xml:lang="en"><title type="html">My SG cities</title><link href="/2019/07/26/My-SG-Cities.html" rel="alternate" type="text/html" title="My SG cities" /><published>2019-07-26T00:00:00+07:00</published><updated>2019-07-26T00:00:00+07:00</updated><id>/2019/07/26/My-SG-Cities</id><content type="html" xml:base="/2019/07/26/My-SG-Cities.html">&lt;p&gt;&lt;strong&gt;Singapore - Saigon, my “SG” duo&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;2am at Jewel, Singapore. My flight back to Saigon will take off at 7am.&lt;/p&gt;

&lt;p&gt;I should only be here around 4:30am earliest but I had forgotten to return the laptop charger to office and needed to make a detour trip there. So heck, decided to just sleep at the airport like during the student days, just for once. Reached Jewel around 12:15am and it has been fun so far.&lt;/p&gt;

&lt;p&gt;The last few months went by like a flash. Since moving back to work mainly in Vietnam, I’ve been adapted to the new environment. 
The Vietnamese team has sped up the development process quite a bit. There is no more &lt;em&gt;I, myself and me&lt;/em&gt; team. New challenges arrived since I didn’t have any experience on building a team yet. 
This is my first, but so far, I’ve been blessed. We are very close to achieve the key milestone to launch our product which has been in its concept for 5 years and in its cocoon for 1 year plus. Both exciting and scary.&lt;/p&gt;

&lt;p&gt;As the same time, wifey and I now expect a child early next year. I was and still am overwhelmed with joy and worries. At this very moment, I feel like I am not even adult enough to be a father. But what to do, I guess we will grow into it, just like our fathers have done.&lt;/p&gt;

&lt;p&gt;It has been a very exciting year full of challenges and hopefully rewards too.&lt;/p&gt;

&lt;h2 id=&quot;different-environments&quot;&gt;Different environments&lt;/h2&gt;

&lt;p&gt;Sitting here in the airport now is very different from sleeping at budget airline terminal almost a decade back. I was trying to save money then (1.5x night taxi fare from NTU to airport is a no-no-no for a foreign student) and the experience sleeping through was pretty horrible.&lt;/p&gt;

&lt;p&gt;Singapore since then has closed down its budget terminal, adding another terminal 4, Jewel (connector for all terminals) and plenty of other projects that I have lost count on. This, the speed and quality of construction in Singapore, has never stopped to amaze me since the first day I landed 14 years ago. Originating from a country with slow and corrupted construction industry, Singapore has open my eyes in a big way.&lt;/p&gt;

&lt;p&gt;By working in both cities (Singapore and Saigon), I have realized there are so many potentials on both sides.&lt;/p&gt;

&lt;h3 id=&quot;singapore&quot;&gt;Singapore&lt;/h3&gt;
&lt;p&gt;In Singapore, it is the facility and the business environment.
&lt;img src=&quot;/images/2019Jul/singapore.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About the facility aspect, it has excellent roads/buildings/offices with 24 hr access, covered walk ways everywhere and everything is super well maintained. You won’t realize that until you go to Saigon (or any other cities for that matter, just look at the Hong Kong’s unmaintained version of HDB). Ex: Our Vietnamese office has power shutdown almost every month or 2. I have been in fewer shutdowns in the total 14 years I stayed in Singapore.
Business environment in Singapore is extremely supportive for SME. Low tax rate, even none for low revenue company. There are grants that SME can tap in as well. Also, all services could be done online from filing tax to renew your business. It is not like that at all in Vietnam.&lt;/p&gt;

&lt;h3 id=&quot;saigon&quot;&gt;Saigon&lt;/h3&gt;
&lt;p&gt;Saigon, however, is more vibrant on the human resource market. 
&lt;img src=&quot;/images/2019Jul/saigon.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The developers I’ve found in Saigon are hungrier and managing stresses better than in Singapore (or maybe I just suck at hiring. idk). 
I have always found it hard to make a Singaporean employee/ subordinate feel the urgency to act. 
To be honest, I think a lot of Singaporeans don’t even need a job since they are already quite well off. 
(From my experience, it is also not common for a Singapore company to sack its staff. Usually it is a gentle asking for resign).&lt;/p&gt;

&lt;p&gt;That’s not the case in Saigon. The city is still under developed, its first metro plan will probably still be delayed until 2025. 
There are a lot more problems to solve in Saigon than in Singapore. 
Therefore, there are more opportunities as well.&lt;/p&gt;

&lt;p&gt;At the same time, it is much harder to hire people in Singapore with the ratio quota for Singaporean vs. Foreigner. This is a challenge for SME because Singaporeans will usually ask for higher salary.&lt;/p&gt;

&lt;p&gt;I do love both cities, one has given me the root, the home, shaping my basic view on life, the other one has given me the freedom/comfort to grow into what I want to be. I feel like there are so much these 2 cities can learn from each other.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Singapore will then be happier and Saigon will be then more advanced and comfortable.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This is the end of my rambling, see you again maybe at another 2am.&lt;/p&gt;</content><author><name></name></author><category term="life" /><category term="work" /><summary type="html">Singapore - Saigon, my “SG” duo</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/2019Jul/sg-duo.png" /></entry><entry xml:lang="en"><title type="html">Music from command line</title><link href="/2019/03/03/Music-from-command.html" rel="alternate" type="text/html" title="Music from command line" /><published>2019-03-03T00:00:00+07:00</published><updated>2019-03-03T00:00:00+07:00</updated><id>/2019/03/03/Music-from-command</id><content type="html" xml:base="/2019/03/03/Music-from-command.html">&lt;p&gt;Pretty sure I am very late to the game but only recently I’ve found out how to 
download and listen to music right from the &lt;code&gt;Terminal&lt;/code&gt; (or &lt;code&gt;iTerm2&lt;/code&gt;, whichever your terminal is).&lt;/p&gt;

&lt;p&gt;It’s great, everything is seamless.
My combination is &lt;a href=&quot;https://cmus.github.io/&quot;&gt;cmus&lt;/a&gt; as player and &lt;a href=&quot;https://github.com/rg3/youtube-dl&quot;&gt;youtube-dl&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;download-youtube-music-with-youtube-dl&quot;&gt;Download youtube music with &lt;code&gt;youtube-dl&lt;/code&gt;&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;1. Installation&lt;/strong&gt;&lt;br /&gt;
On Mac, with &lt;code&gt;Homebrew&lt;/code&gt;, it’s just a command away:&lt;br /&gt;
&lt;code&gt;brew install youtube-dl&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;or with &lt;code&gt;MacPorts&lt;/code&gt;:&lt;br /&gt;
&lt;code&gt;sudo port install youtube-dl&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2. Add alias for common usage&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;youtube-dl&lt;/code&gt; is a very powerful tool to download video/audio from Youtube.&lt;br /&gt;
Its syntax is, therefore, also pretty complicated.&lt;/p&gt;

&lt;p&gt;For my usage, I simply needed the mp3 versions of the music videos. 
Also some of the meta information like artist and title should be correct at least for easier classification later.&lt;/p&gt;

&lt;p&gt;So here are 3 aliases that I commonly used to make the downloading easier:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;alias&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ytdl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;youtube-dl --extract-audio --audio-format mp3 --add-metadata --metadata-from-title &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;(?P&amp;lt;title&amp;gt;.+?) (-|_|&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) (?P&amp;lt;artist&amp;gt;.+)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -o &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%(title)s.mkv&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;  
&lt;span class=&quot;k&quot;&gt;alias&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ytdl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;youtube-dl --extract-audio --audio-format mp3 --add-metadata --metadata-from-title &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;(?P&amp;lt;title&amp;gt;.+?) (-|_|&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) (?P&amp;lt;artist&amp;gt;.+) (-|_|&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) (?P&amp;lt;album&amp;gt;.+)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -o &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%(title)s.mkv&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;alias&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ytdl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;youtube-dl --extract-audio --audio-format mp3 --add-metadata --metadata-from-title &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;(?P&amp;lt;artist&amp;gt;.+?) (-|_|&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) (?P&amp;lt;title&amp;gt;.+)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -o &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%(title)s.mkv&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can put this to your &lt;code&gt;.bashrc&lt;/code&gt;, and start using as follow:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;sb&quot;&gt;`ytdl [youtube url]`&lt;/span&gt;  &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;What the commands will be doing are:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Extract audio and save the mp3 version of youtube video specify&lt;/li&gt;
  &lt;li&gt;Save meta infos like &lt;code&gt;artist&lt;/code&gt; and &lt;code&gt;title&lt;/code&gt; according to partern&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;For &lt;code&gt;ytdl&lt;/code&gt;, the pattern is:&lt;/strong&gt; &lt;code&gt;[title] [separator] [artist]&lt;/code&gt;, in which &lt;code&gt;[separator]&lt;/code&gt; can be &lt;code&gt;-&lt;/code&gt; or &lt;code&gt;_&lt;/code&gt; or &lt;code&gt;|&lt;/code&gt;&lt;br /&gt;
For example, in the case of following video:&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/aTgXgN9fOsk&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;code&gt;title&lt;/code&gt; will be: &lt;code&gt;(Charlie Puth) Attention&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The &lt;code&gt;artist&lt;/code&gt; will be:  &lt;code&gt;Josephine Alexandra | Fingerstyle Guitar Cover&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I used short forms of &lt;code&gt;artist&lt;/code&gt; (&lt;code&gt;a&lt;/code&gt;), &lt;code&gt;title&lt;/code&gt; (&lt;code&gt;t&lt;/code&gt;), &lt;code&gt;album&lt;/code&gt; (&lt;code&gt;al&lt;/code&gt;) as reminder how the pattern looks like&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;For &lt;code&gt;ytdl-atal&lt;/code&gt; (or &lt;code&gt;artist&lt;/code&gt;, &lt;code&gt;title&lt;/code&gt;, &lt;code&gt;album&lt;/code&gt;), the pattern is:&lt;/strong&gt; &lt;code&gt;[title] [separator] [artist] [separator] [album]&lt;/code&gt;, in which &lt;code&gt;[separator]&lt;/code&gt; is same as above with extra &lt;code&gt;(&lt;/code&gt; in case of last separator.&lt;/p&gt;

&lt;p&gt;With the same video above, if we use &lt;code&gt;ytdl-atal&lt;/code&gt;  the result would be:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;code&gt;title&lt;/code&gt; will be: &lt;code&gt;(Charlie Puth) Attention&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The &lt;code&gt;artist&lt;/code&gt; will be:  &lt;code&gt;Josephine Alexandra&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The &lt;code&gt;album&lt;/code&gt; will be:  &lt;code&gt;Fingerstyle Guitar Cover&lt;/code&gt;&lt;br /&gt;
It is still not perfect yet but it is quite enough for me&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code&gt;ytdl-ta&lt;/code&gt; is just a reverse in order of &lt;code&gt;ytdl&lt;/code&gt;, should be used for cases like in this video:&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/tAKnT0g8MtA&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;Of course there will be more patterns of title you will see on youtube but those are the common ones.&lt;/p&gt;

&lt;h2 id=&quot;play-music-with-cmus&quot;&gt;Play music with &lt;code&gt;cmus&lt;/code&gt;&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;1. Installation&lt;/strong&gt;&lt;br /&gt;
Again with magic of &lt;code&gt;Homebrew&lt;/code&gt;, to install &lt;code&gt;cmus&lt;/code&gt; on Mac is simply:&lt;br /&gt;
&lt;code&gt;brew install cmus&lt;/code&gt;
The first installation, I’ve accidentally downloaded and compiled the build on &lt;code&gt;https://cmus.github.io/#download&lt;/code&gt;. But still &lt;code&gt;Homebrew&lt;/code&gt; installation is much better.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2. Usage&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;cmus&lt;/code&gt; is a very useful player when you mostly work on Terminal. Its UI has 7 views (that you can switch around using number key 1-7 once cmus open):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;VIEWS&lt;/span&gt;
       &lt;span class=&quot;no&quot;&gt;There&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;no&quot;&gt;Press&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;change&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;active&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Library&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Display&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;all&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tracks&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;so&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;called&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Tracks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;artist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;album&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;no&quot;&gt;Artist&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorting&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alphabetically&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Albums&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Sorted&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;library&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Displays&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;same&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;but&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;simple&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;which&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;automatically&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criteria&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Playlist&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Displays&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;editable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;playlist&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optional&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorting&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Play&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Queue&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Displays&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tracks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;which&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;played&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;These&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tracks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;played&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;anything&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;playlist&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Browser&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Directory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;browser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;no&quot;&gt;In&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;music&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;can&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;added&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;either&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;playlist&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filesystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Filters&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Lists&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defined&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

       &lt;span class=&quot;no&quot;&gt;Settings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;no&quot;&gt;Lists&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keybindings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unbound&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;commands&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;no&quot;&gt;Remove&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;bindings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;change&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bindings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enter&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;toggle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If you are used to use terminal, it won’t be that hard to use &lt;code&gt;cmus&lt;/code&gt;. But to make it easier to remember the list of commands, I recommend this &lt;a href=&quot;https://www.cheatography.com/stephenjjohnson/cheat-sheets/cmus/pdf/&quot;&gt;cheatsheet&lt;/a&gt;&lt;br /&gt;
As of the 2 video above, here is what it will look like after we’ve added them in playlist:&lt;br /&gt;
&lt;img src=&quot;/images/2019Mar/cmus-playlist.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;One thing I definitely loved about &lt;code&gt;cmus&lt;/code&gt; is that the navigation keys are &lt;code&gt;j&lt;/code&gt;, &lt;code&gt;k&lt;/code&gt; for up and down which is super familiar if you used &lt;code&gt;vim&lt;/code&gt;. So again, everything is seamless. 
There are much more functionalities of cmus to explore and I am still in the learning process.&lt;/p&gt;

&lt;p&gt;Hope you will find this useful if you are also late to the game :)&lt;/p&gt;</content><author><name></name></author><category term="life" /><category term="music" /><summary type="html">Pretty sure I am very late to the game but only recently I’ve found out how to download and listen to music right from the Terminal (or iTerm2, whichever your terminal is).</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/2019Mar/post-music.jpg" /></entry><entry xml:lang="en"><title type="html">Happy New Year 2019!</title><link href="/2019/01/06/2018-Review.html" rel="alternate" type="text/html" title="Happy New Year 2019!" /><published>2019-01-06T00:00:00+07:00</published><updated>2019-01-06T00:00:00+07:00</updated><id>/2019/01/06/2018-Review</id><content type="html" xml:base="/2019/01/06/2018-Review.html">&lt;p&gt;I have stopped blogging for a while, more than a year and a half to be more accurate.
Last year has been tough when I have had to juggled between a crazily time-consuming full time job and my own ERPNext venture.
It’s a pity that in the end, I had to let the venture go, at least for now.
Though there are quite a few things I’ve learned technically this year but at the same time, there wasn’t any time left to blog about those.&lt;/p&gt;

&lt;p&gt;Something I’ve done over last year:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Temporarily halt operations of my own ERPNext company to focus on my full time first. Will restart the first chance I’ve got.&lt;/li&gt;
  &lt;li&gt;Switch to use vim through out 2018 intead of PyCharm for python. It’s pretty great!!&lt;/li&gt;
  &lt;li&gt;Fly back and forth between Singapore and Vietnam to set up the Vietnamese team&lt;/li&gt;
  &lt;li&gt;Started with investment and learn more about value investing. The market in 2018 has a lot of ups and downs, it was a wild ride. But learnt quite a lot as well.&lt;/li&gt;
  &lt;li&gt;Visited beautiful Hunan China and survive on the limited Chinese vocabulary I have. A long overdue break with a lot of fun. Also first time to see snow and it was awesome!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Just drop here a few lines to remind myself of this year. Now let’s march to 2019 with full power!!!&lt;/p&gt;</content><author><name></name></author><category term="life" /><summary type="html">I have stopped blogging for a while, more than a year and a half to be more accurate. Last year has been tough when I have had to juggled between a crazily time-consuming full time job and my own ERPNext venture. It’s a pity that in the end, I had to let the venture go, at least for now. Though there are quite a few things I’ve learned technically this year but at the same time, there wasn’t any time left to blog about those.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/newyear.png" /></entry><entry xml:lang="en"><title type="html">Azure: Restore a deleted VM</title><link href="/2017/04/04/Azure-restore-deleted-vm.html" rel="alternate" type="text/html" title="Azure: Restore a deleted VM" /><published>2017-04-04T00:00:00+07:00</published><updated>2017-04-04T00:00:00+07:00</updated><id>/2017/04/04/Azure-restore-deleted-vm</id><content type="html" xml:base="/2017/04/04/Azure-restore-deleted-vm.html">&lt;p&gt;Have been using AWS and DO for the past few years, I have some struggles when moving to Azure. For one thing, even with the new portal, Azure’s UI is still cluttering and quite hard to navigate around, let alone using any short cut.&lt;/p&gt;

&lt;p&gt;And so naturally I’ve made mistake, deleted a wrong VM and it disappeared in a few seconds. Only then I’ve realized how stupid that was! On DO, it was supremely easy to just restore a VM or even AWS given that you have the backup set up or made snapshot prior to that. Azure ? I’ve got to search all over the place. Most results show how to do it with PowerShell, but I am on Mac.&lt;/p&gt;

&lt;p&gt;Finally, really glad that I’ve found this &lt;a href=&quot;https://github.com/Azure/azure-quickstart-templates/&quot;&gt;repo&lt;/a&gt;, which contains a list of Azure pre-made templates. Also as it turned out, Azure keeps the OS disk of the VM separately in the storage account. So we can still create another VM with it.&lt;/p&gt;

&lt;p&gt;So here is how to restore a deleted VM:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1. Find the correct disk image that stored your VM image, copy the VHD Uri&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Check on all your storage account to find the correct disk image for your VM. This could be a bit tricky if you have a lot of VMs since the name may not be descriptive the first time you created.
  &lt;img src=&quot;/images/azure/storage-acc.png&quot; alt=&quot;&quot; /&gt;
  &lt;img src=&quot;/images/azure/storage-acc-2.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Find the correct vhd by looking at the name and modified time. Then copy the VHD url for later use
  &lt;img src=&quot;/images/azure/storage-acc-3.png&quot; alt=&quot;&quot; /&gt;
  &lt;img src=&quot;/images/azure/storage-acc-4.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;2. Next use the template to create VM from the VHD image.&lt;/strong&gt; &lt;br /&gt;
Depend on whether you want to create a new VNET or not, you can choose between &lt;a href=&quot;https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-specialized-vhd-existing-vnet&quot;&gt;this template&lt;/a&gt; and &lt;a href=&quot;https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-specialized-vhd&quot;&gt;this other template&lt;/a&gt;.&lt;br /&gt;
Just click &lt;strong&gt;Deploy to Azure&lt;/strong&gt; while already signed in to Azure and it will create a form for you to fill in and create the VM such as follow&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/azure/Microsoft-Azure-Deploy.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Fill in the Vhd Uri obtained above and the rest of the necessary fields. Now, if you create a VM directly from a official image, that’s it, you have your VM back.&lt;/p&gt;

&lt;p&gt;But in my case I was using a third party image from Bitnami and there goes another error. It was along the line of:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;The&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operation&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;completed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;provisioning&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Failed'&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Creating a virtual machine from Marketplace image requires Plan information in the request. OS disk name is abcd-osdisk&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;How to proceed from here ? It’s a bit more trickier… The plan information is still hard to retrieve. So we trace back through log to get it. `&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3. Add plan information to template&lt;/strong&gt;
Go back to your resource group and click on the “Deployment” portion&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/azure/Deployment--Microsoft-Azure.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This leads to a list of previous deployments within the same resource group. Select the one that’ve created your original VM. Then click &lt;strong&gt;View Template&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/azure/Deployment-Template-Azure-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It will proceed to allow to edit a JSON file with the plan information that we need to include in our new template from step 2. The plan info looks some thing like this:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&quot;resources&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Microsoft.Compute/virtualMachines&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[parameters('virtualMachineName')]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;apiVersion&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2016-04-30-preview&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;location&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[parameters('location')]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&quot;plan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;9-5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;publisher&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bitnami&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&quot;product&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;postgresql&quot;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; 
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Copy the plan information portion and put it in our template in Step 2 like this (take note that the type where you should insert should be “virtualMachines”:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/azure/Edit-template.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/images/azure/Edit-template---Microsoft-Azure-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Once done, press save and continue with the template to redeploy your deleted VM.&lt;/p&gt;

&lt;p&gt;Quite some works just to restore a VM. But i am grateful that at least the vhd is not gone together with the VM itself.)&lt;/p&gt;</content><author><name></name></author><category term="azure" /><category term="server" /><category term="tech" /><summary type="html">Have been using AWS and DO for the past few years, I have some struggles when moving to Azure. For one thing, even with the new portal, Azure’s UI is still cluttering and quite hard to navigate around, let alone using any short cut.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/azure/azure-microsoft.png" /></entry><entry xml:lang="en"><title type="html">Development with ERPNext - Part 1: Setup using Vagrant box</title><link href="/2016/12/21/ERPNext-development-part-1.html" rel="alternate" type="text/html" title="Development with ERPNext - Part 1: Setup using Vagrant box" /><published>2016-12-21T00:00:00+07:00</published><updated>2016-12-21T00:00:00+07:00</updated><id>/2016/12/21/ERPNext-development-part-1</id><content type="html" xml:base="/2016/12/21/ERPNext-development-part-1.html">&lt;p&gt;One thing that was quite impressive when I first started working with ERPNext was the underlying &lt;strong&gt;Frappe&lt;/strong&gt; Framework. It is highly extensible multi-tenant platform. In a way, Frappe acts as a host for all other apps to run on top, including ERPNext itself.&lt;/p&gt;

&lt;p&gt;For reference, here is the official &lt;a href=&quot;http://frappe.github.io/erpnext/user/manual/en/&quot;&gt;User Manual&lt;/a&gt; from ERPNext.&lt;/p&gt;

&lt;p&gt;Following this though, I still found it hard to have everything set up nicely for development. There are 2 approaches I took:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Install &lt;code&gt;bench&lt;/code&gt; directly on my Macbook. Problem with this arrives if we wanna have different version of &lt;em&gt;ERPNext/Frappe&lt;/em&gt;. There is no way to make it clean&lt;/li&gt;
  &lt;li&gt;Install using &lt;strong&gt;VirtualBox/Vagrant&lt;/strong&gt;. It solves the first problem but then there is no actual documentation on how to set it up for development.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Therefore i will try to show how I set up mine using Vagrant Box in this post. It turns out to be pretty simple and convenient.&lt;/p&gt;

&lt;h3 id=&quot;setup&quot;&gt;Setup&lt;/h3&gt;
&lt;h5 id=&quot;1-download-vagrant-box&quot;&gt;1. Download Vagrant box&lt;/h5&gt;
&lt;p&gt;For simplicity, I will skip the step on how to install Vagrant/Virtual Box. Just make sure you have those installed. The official vagrant box is here: https://erpnext.com/download&lt;/p&gt;

&lt;h5 id=&quot;2-add-vagrant-box-and-start-the-vm&quot;&gt;2. Add vagrant box and start the vm&lt;/h5&gt;
&lt;p&gt;Usually i will put the box in my project folder as follow:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;project_a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;----&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ERPNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Open a Command Terminal on the downloaded location, and add the vagrant box&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;vagrant&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ERPNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ERPNextTest&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To see if it is actually added:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;vagrant&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-----&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;ERPNextTest&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;virtualbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Next add the following simple &lt;code&gt;Vagrantfile&lt;/code&gt; in the same folder as the box with the following content:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ERPNextTest&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;private_network&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;ip: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.50.5&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&quot;https://www.vagrantup.com/docs/vagrantfile/&quot;&gt;Vagrantfile&lt;/a&gt; is used to inform Vagrant on how to provision the vm. I have chosen Static IP instead of DHCP to avoid the need to find IP later. More on Vagrant network configuration &lt;a href=&quot;https://www.vagrantup.com/docs/networking/private_network.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Next let’s just start up the box with:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;vagrant&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;3-copy-the-bench-folder-out&quot;&gt;3. Copy the bench folder out&lt;/h4&gt;
&lt;p&gt;After the box finishes setting up, we can take a look by ssh in &lt;code&gt;vagrant ssh&lt;/code&gt;. It will look something like this when we do a list out.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt;
&lt;span class=&quot;ss&quot;&gt;username: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;
&lt;span class=&quot;ss&quot;&gt;password: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;....&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Last&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;login: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Wed&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2016&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;10.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@erpnext&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:~&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bench&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;repo&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bench&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@erpnext&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:~&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ll&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bench&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxrwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;374&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/
drwxrwxr-x 1 frappe frappe  170 Dec  6 10:15 apps/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxrwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;204&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6148&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;DS_Store&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxrwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;340&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxrwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;170&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxrwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;238&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node_modules&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;patches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;txt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;405&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Procfile&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drwxrwxr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;238&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dec&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sites&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@erpnext&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:~&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now the main problem now is how to access these files as local files. Vagrant has a configuration called &lt;code&gt;synced_folders&lt;/code&gt;. This, however, will prioritize syncing from host machine to guest. So if you have an empty host folder, it will screw up the initial setting from ERPNext. &lt;em&gt;My solution is simple: wait for the &lt;code&gt;frappe-bench&lt;/code&gt; folder to finish setting up, then copy it out and sync.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Remember the static ip above, it will be useful here, we use scp to copy the whole folder out. Because it’s a local server, it’s pretty fast.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;scp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;50.5&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:~&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bench&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Anyway, as long as the copying’s done, it will be much better because we can continue use git on these local files and still have it synced to the VM.&lt;/p&gt;

&lt;p&gt;We can use tar for this as well:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;ssh&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frappe&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;50.5&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'cd ~/frappe-bench &amp;amp;&amp;amp; tar czvf - .'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xzf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;4-last-step-is-to-enable-synced_folder&quot;&gt;4. Last step is to enable synced_folder&lt;/h4&gt;
&lt;p&gt;Add a line to your &lt;code&gt;Vagrantfile&lt;/code&gt; so that it looks like below:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ERPNextTest&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;private_network&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;ip: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.50.5&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;synced_folder&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;code/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/home/frappe/frappe-bench&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Next, &lt;code&gt;vagrant reload&lt;/code&gt;. 
After this you will have a local folder that automatically synced to the Vagrant Box. Any changes made to the apps will be updated. At the same time, since those files are local, you can still make use of the git versioning as usual. So there you have it, my one simple trick to set up ERPNext development environment using Vagrant Box.&lt;/p&gt;

&lt;p&gt;This is much cleaner than directly install on Host machine, be it Mac or Windows (because of multi-versions conflict) and also quite convenient compare to keep updating a file from editor and upload the vagrant box.&lt;/p&gt;</content><author><name></name></author><category term="erpnext" /><category term="vagrant" /><category term="tech" /><summary type="html">One thing that was quite impressive when I first started working with ERPNext was the underlying Frappe Framework. It is highly extensible multi-tenant platform. In a way, Frappe acts as a host for all other apps to run on top, including ERPNext itself.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/erpnext-logo-copy.png" /></entry><entry xml:lang="en"><title type="html">Docker Compose to host Django APIs</title><link href="/2016/12/04/Docker-compose-mistake.html" rel="alternate" type="text/html" title="Docker Compose to host Django APIs" /><published>2016-12-04T00:00:00+07:00</published><updated>2016-12-04T00:00:00+07:00</updated><id>/2016/12/04/Docker-compose-mistake</id><content type="html" xml:base="/2016/12/04/Docker-compose-mistake.html">&lt;p&gt;Docker compose helps to simplify a lot of steps in hosting the APIs especially with auto reload. Details on how I’ve set up the environment will be posted at another time.&lt;/p&gt;

&lt;h5 id=&quot;the-problem&quot;&gt;The Problem&lt;/h5&gt;
&lt;p&gt;But being it the first time I’ve deployed anything with Docker Compose, I’ve made a silly mistake, which drastically slow down the performance. At one point in time the API is &lt;strong&gt;60x slower than normal&lt;/strong&gt;, and I’ve checked the code, nothing seems abnormal. You can imagine what level of frustration I have with that.&lt;/p&gt;

&lt;p&gt;This post is simply a reminder to myself not to repeat the simple mistake again.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;So here it is:&lt;/strong&gt; every time we do any updates that are related to Database in Django we will need to at least apply a migrations. And how i usually do that (&lt;strong&gt;api&lt;/strong&gt; is the service that i need to run command on):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;yaml&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;production&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;yaml&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;migrate&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;What it does is it will create another container and run the command execution there to migrate the django. However, I didn’t know the container will stay there if you don’t do any thing extra.&lt;/p&gt;

&lt;p&gt;So it turns out, with only all these supposedly one time commands, I’ve ended up to have tens of ghost containers… And the server does not take it so well. The solution is simply to stop and remove all the unnecessary containers.&lt;/p&gt;

&lt;p&gt;So simple note, next time any one who do 1 time command on docker-compose, please do add the &lt;code&gt;--rm&lt;/code&gt; flag like this:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;yaml&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;production&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;yaml&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;migrate&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;At least, it won’t cost you hours or days to figure out why suddenly your APIs are supremely slow.&lt;/p&gt;

&lt;h5 id=&quot;enhancement&quot;&gt;Enhancement&lt;/h5&gt;
&lt;p&gt;Now the above commands does work now. However, it’s quite tedious to keep repeating &lt;code&gt;docker-compose -f ...&lt;/code&gt; every time you want to run a command.&lt;/p&gt;

&lt;p&gt;Luckily we have &lt;code&gt;alias&lt;/code&gt; to the rescue. With this, we can simply assign alias for the repeating command.&lt;/p&gt;

&lt;p&gt;So first open your &lt;code&gt;.bashrc&lt;/code&gt; for editing: &lt;code&gt;nano ~/.bashrc&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Add these lines at the end of the file (and remember to change the paths to the correct paths you have, as well as the service name &lt;strong&gt;api&lt;/strong&gt;)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Add alias for docker compose command&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;alias&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;docker-compose -f /path/to/docker-compose.yml -f /path/to/docker-compose.production.yml&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;alias&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;docker-prod run --rm api&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Save &lt;code&gt;.bashrc&lt;/code&gt; and apply its effect by: &lt;code&gt;source ~/.bashrc&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;With this set up, you can now use much shorter/prettier commands such as:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Restart services&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prod&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;restart&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# DB migrate&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;api&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;py&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;migrate&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;These are just tips right now, will try to come up with a full tutorial on setting up the environment next time. Have fun!`&lt;/p&gt;</content><author><name></name></author><category term="django" /><category term="tech" /><summary type="html">Docker compose helps to simplify a lot of steps in hosting the APIs especially with auto reload. Details on how I’ve set up the environment will be posted at another time.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/images/django-docker.png" /></entry></feed>